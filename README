# 1/30/2012 
The scripts provided here will allow you to run the preferential LD approach in a cluster.

Requirement:
1. Your variant catalog in binary PED format (SNVcollection.bed, SNVcollection.bim, SNVcollection.fam and SNVcollection.lmiss), which should be put in input/SNVcollection/ directory. SNV should be named as "chr:posAllele1Allele2", eg: 1:291CT. The two alleles are in alphabet order in the SNV name.
2. The GWAS discovery SNPs in input/GWASsnps/ directory. See input/GWASsnps/example_snps for example. 
3. SNP table of genotyping platform in input/GWAS_array/ directory. We provide the snp tables of several platforms in this folder. See input/GWAS_array/array.list for a list of the platforms.  
4. PLINK
5. Haploview
6. R

Example of running the preferential LD approach:
cd scripts/
mkdir tmpscript/
./GWASsnp.info.SGE.sh example_snps # get information for the discovery SNPs (generate example_snps.info in input/GWASsnps); take ~12 mins
./tmpscript/rm.GWASsnpinfo.sh # remove the SGE script and log file after checking for errors and warnings
###############################################################
### step 1: collect candidate SNVs around the discovery SNP ###
###############################################################
./targetSNV.SGE.sh example_snps.info 500000 0.15 Y 1e-6 0.005 # generate SGE scripts and qsub.step1.sh
./tmpscript/qsub.step1.sh # take ~10 mins 
./tmpscript/rm.step1.sh # remove the SGE scripts and log files after checking for errors and warnings
###################################################################################
### step 2: identify candidate SNVs with preferential LD with the discovery SNP ###
###################################################################################
./arraySNPHaploview.SGE.sh example_snps.info 0.05 # generate SGE scripts and qsub.step2.sh
./tmpscript/qsub.step2.sh # take ~6 mins if there are enough nodes
./tmpscript/rm.step2.sh # remove the SGE scripts and log files after checking for errors and warnings
########################################################################################
### step 3: identify candidate SNVs whose LD with the discovery SNP is not by chance ###
########################################################################################
./randomHaploview.SGE.sh example_snps.info 2000 0.1 # generate SGE scripts and qsub.step3.sh
./tmpscript/qsub.step3.sh # take ~10 mins if there are enough nodes
./tmpscript/rm.step3.sh # remove the SGE scripts and log files after checking for errors and warnings
#########################################
### step 4: prioritize candidate SNVs ###
#########################################
./variantVSconservation.SGE.sh example_snps.info 0.05 # generate SGE scripts and qsub.step4.sh
./tmpscript/qsub.step4.sh # take 1~2 mins
./tmpscript/rm.step4.sh

Final candidates are in file targetSNV.4.ordered:
Column	Description
1	SNV name
2	p-value
3	sorting score (candidate SNVs are sorted in descending order)
4	phastCons for primate
5	the fraction of permutations with r2 >= the observed r2 (col10)
6	# of times where r2 >= the observed r2 / # of permutations
7	PLD: the fraction of GWAS SNPs with r2 >= the observed r2 (on the same chromosome as the discovery SNP)
8	# of GWAS SNPs with r2 >= the observed r2 / # of GWAS SNPs analyzed
9	D' between the candidate SNV and the discovery SNP
10	r2 between the candidate SNV and the discovery SNP
11	minor allele (allele 1)
12	minor allele frequency
13	genotype counts (11/12/22)
14	HWE p-value
